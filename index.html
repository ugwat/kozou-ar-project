<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>KOZOU+ AR Experience</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body { 
      margin: 0; 
      padding: 0;
      width: 100%; 
      height: 100%;
      background-color: #000;
      position: fixed;
      overflow: hidden;
    }
    
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: black;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      color: white;
    }
    
    #ar-container {
      width: 100%;
      height: 100%;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1;
      display: none;
    }
    
    #camera-view {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 10;
      filter: brightness(0.85); /* èƒŒæ™¯ã‚’ã‚„ã‚„æš—ã */
    }
    
    .scene {
      position: absolute;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      perspective: 1500px;
      z-index: 20;
    }
    
    .carousel {
      position: absolute;
      width: 100%;
      height: 300px;
      bottom: 180px; /* ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰è¡¨é¢ã®ä½ç½®ã‚’èª¿æ•´ */
      transform-style: preserve-3d;
      transform: rotateX(15deg); /* ã‚„ã‚„æ–œã‚ä¸Šã‹ã‚‰ã®ã‚¢ãƒ³ã‚°ãƒ« */
    }
    
    .card-wrapper {
      position: absolute;
      width: 320px;
      height: 200px; /* æ¨ªå‹ã‚«ãƒ¼ãƒ‰ */
      transform-style: preserve-3d;
      transition: transform 0.5s ease-out, opacity 0.5s ease-out;
      transform-origin: center center;
      /* ä½ç½®ã¯transformã§å‹•çš„ã«è¨­å®š */
      top: 0;
      left: calc(50% - 160px); /* ç”»é¢ä¸­å¤®ã«é…ç½® */
    }
    
    .card {
      position: absolute;
      width: 100%;
      height: 0; /* æœ€åˆã¯é«˜ã•0ï¼ˆè¦‹ãˆãªã„ï¼‰ */
      bottom: 0;
      background-image: url('./assets/1waku.png');
      background-size: cover;
      background-position: bottom center;
      filter: drop-shadow(0 0 10px rgba(0, 200, 255, 0.7));
      opacity: 0.9; /* æœ€åˆã¯å°‘ã—é€æ˜ */
      transition: height 2s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 2s cubic-bezier(0.2, 0.8, 0.2, 1);
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 200, 255, 0.7);
    }
    
    .card-reflection {
      position: absolute;
      width: 100%;
      height: 0; /* æœ€åˆã¯é«˜ã•0ï¼ˆè¦‹ãˆãªã„ï¼‰ */
      top: 0; /* åå°„ãªã®ã§ä¸Šã‹ã‚‰å§‹ã¾ã‚‹ */
      transform: rotateX(180deg) scaleY(0.6); /* ä¸Šä¸‹åè»¢ã—ã€å°‘ã—ç¸®ã‚ã‚‹ */
      background-image: url('./assets/1waku.png');
      background-size: cover;
      background-position: bottom center;
      opacity: 0.3; /* åå°„ã¯é€æ˜åº¦é«˜ã‚ */
      filter: blur(3px) brightness(0.7); /* ã¼ã‹ã—ã¦æš—ã */
      transition: height 2s cubic-bezier(0.2, 0.8, 0.2, 1);
      border-radius: 10px;
    }
    
    @keyframes glowPulse {
      0% {
        filter: drop-shadow(0 0 5px rgba(0, 200, 255, 0.5)) blur(0px);
      }
      50% {
        filter: drop-shadow(0 0 15px rgba(0, 200, 255, 0.8)) blur(0px);
      }
      100% {
        filter: drop-shadow(0 0 5px rgba(0, 200, 255, 0.5)) blur(0px);
      }
    }
    
    @keyframes reflectionGlow {
      0% {
        filter: blur(3px) brightness(0.7) drop-shadow(0 0 2px rgba(0, 200, 255, 0.3));
      }
      50% {
        filter: blur(3px) brightness(0.7) drop-shadow(0 0 7px rgba(0, 200, 255, 0.5));
      }
      100% {
        filter: blur(3px) brightness(0.7) drop-shadow(0 0 2px rgba(0, 200, 255, 0.3));
      }
    }
    
   
    
    /* ã‚¹ãƒ¯ã‚¤ãƒ—èª˜å°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
    .swipe-hint {
      position: absolute;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      color: rgba(0, 200, 255, 0.8);
      font-size: 14px;
      opacity: 0;
      transition: opacity 1s ease;
      z-index: 100;
      text-align: center;
      text-shadow: 0 0 10px rgba(0, 200, 255, 0.8);
    }
    
    .swipe-arrows {
      display: flex;
      justify-content: center;
      margin-top: 10px;
    }
    
    .swipe-arrow {
      margin: 0 20px;
      font-size: 24px;
      animation: pulse 1.5s infinite ease-in-out;
    }
    
    @keyframes pulse {
      0% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
      100% { opacity: 0.3; transform: scale(1); }
    }
    
    /* æš—ã„ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(ellipse at center, rgba(0,0,0,0) 30%, rgba(0,0,0,0.6) 100%);
      z-index: 15;
      pointer-events: none;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="loading-screen">
    <div style="border: 5px solid rgba(0, 200, 255, 0.1); border-top: 5px solid #00c8ff; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin-bottom: 20px;"></div>
    <div>èª­ã¿è¾¼ã¿ä¸­...</div>
    <button id="start-button" style="margin-top: 20px; padding: 15px 30px; background-color: #00a2ff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; box-shadow: 0 0 15px rgba(0, 200, 255, 0.5);">ARä½“é¨“ã‚’é–‹å§‹</button>
  </div>

  <div id="ar-container">
    <video id="camera-view" autoplay playsinline></video>
    <div class="overlay"></div>
    
    <div class="scene">
      <div class="carousel">
        <!-- ã‚«ãƒ¼ãƒ‰ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
      </div>
    </div>
    
    <div class="swipe-hint">
      ã‚¹ãƒ¯ã‚¤ãƒ—ã§ã‚«ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆ
      <div class="swipe-arrows">
        <div class="swipe-arrow">â†</div>
        <div class="swipe-arrow">â†’</div>
      </div>
    </div>
  </div>

  <script>
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
    let activeCardIndex = 0;
    let isSwipeEnabled = false; // ã‚¹ãƒ¯ã‚¤ãƒ—æœ‰åŠ¹ãƒ•ãƒ©ã‚°ï¼ˆå‡ºç¾å¾Œã«æœ‰åŠ¹åŒ–ï¼‰
    
    // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆå…±é€šè¨­å®šï¼‰
    const layoutConfig = {
      radius: window.innerWidth * 1.5, // ã‚ˆã‚Šå¤§ããªåŠå¾„ã§å¼§ã‚’åºƒã’ã‚‹
      theta: Math.PI * 0.6, // ç´„108åº¦ã®å¼§
      centerZ: -300, // Zè»¸ã‚ªãƒ•ã‚»ãƒƒãƒˆï¼ˆæ‰‹å‰ã«å¼•ãå‡ºã™ï¼‰
      cardWidth: 320, // ã‚«ãƒ¼ãƒ‰å¹…
      cardSpacing: 1.5, // ã‚«ãƒ¼ãƒ‰é–“ã®é–“éš”ä¿‚æ•°
      maxScale: 1.0, // ä¸­å¤®ã‚«ãƒ¼ãƒ‰ã®ã‚¹ã‚±ãƒ¼ãƒ«
      minScale: 0.7, // ç«¯ã®ã‚«ãƒ¼ãƒ‰ã®ã‚¹ã‚±ãƒ¼ãƒ«
      maxOpacity: 1.0, // ä¸­å¤®ã‚«ãƒ¼ãƒ‰ã®ä¸é€æ˜åº¦
      minOpacity: 0.6 // ç«¯ã®ã‚«ãƒ¼ãƒ‰ã®ä¸é€æ˜åº¦
    };
    
    // DOMã®èª­ã¿è¾¼ã¿å®Œäº†æ™‚ã®å‡¦ç†
    document.addEventListener("DOMContentLoaded", function() {
      console.log("DOMèª­ã¿è¾¼ã¿å®Œäº†");
      
      // é–‹å§‹ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
      document.getElementById('start-button').addEventListener('click', function() {
        document.getElementById('loading-screen').style.display = 'none';
        initAR();
      });
    });
    
    // ARã®åˆæœŸåŒ–
    function initAR() {
      console.log("ARåˆæœŸåŒ–é–‹å§‹");
      
      // ARã‚³ãƒ³ãƒ†ãƒŠã‚’è¡¨ç¤º
      document.getElementById('ar-container').style.display = 'block';
      
      // ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•
      navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
        .then(function(stream) {
          document.getElementById('camera-view').srcObject = stream;
          
          // ã‚«ãƒ¼ãƒ‰ç¾¤ã‚’ç”Ÿæˆ
          createCards();
          
          // ã‚«ãƒ¡ãƒ©èµ·å‹•å¾Œã€ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
          setTimeout(growCards, 1000);
        })
        .catch(function(err) {
          console.error("ã‚«ãƒ¡ãƒ©ã‚¨ãƒ©ãƒ¼:", err);
          console.log("ã‚«ãƒ¡ãƒ©ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ãŒã€ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã§ç¶šè¡Œã—ã¾ã™");
          
          // ã‚«ãƒ¼ãƒ‰ç¾¤ã‚’ç”Ÿæˆ
          createCards();
          
          // ã‚«ãƒ¡ãƒ©ãªã—ã§ã‚‚ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
          setTimeout(growCards, 1000);
        });
    }
    
    // ã‚«ãƒ¼ãƒ‰ç¾¤ã‚’ç”Ÿæˆ
    function createCards() {
      const carousel = document.querySelector('.carousel');
      const totalCards = 5; // ã‚«ãƒ¼ãƒ‰ã®ç·æ•°
      const cardData = [
        { title: "STEP 1", content: "åº•ã®æ–¹ã‹ã‚‰ã—ã£ã‹ã‚Šæ··ãœã‚‹ï¼" },
        { title: "STEP 2", content: "ã‚ˆãæ··ãœã‚‹" },
        { title: "STEP 3", content: "æœ€åˆã®ä¸€å£" },
        { title: "STEP 4", content: "è¿½ã„ãƒ‹ãƒ³ãƒ‹ã‚¯" },
        { title: "STEP 5", content: "å®Œé£Ÿ" }
      ];
      
      // ä¸­å¤®ã®ã‚«ãƒ¼ãƒ‰ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«è¨­å®š
      activeCardIndex = Math.floor(totalCards / 2);
      
      // ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
      for (let i = 0; i < totalCards; i++) {
        // ã‚«ãƒ¼ãƒ‰ãƒ©ãƒƒãƒ‘ãƒ¼ã‚’ä½œæˆ
        const cardWrapper = document.createElement('div');
        cardWrapper.className = 'card-wrapper';
        cardWrapper.id = `card-wrapper-${i}`;
        cardWrapper.dataset.index = i;
        
        // å®Ÿéš›ã®ã‚«ãƒ¼ãƒ‰ã‚’ä½œæˆ
        const card = document.createElement('div');
        card.className = 'card';
        
        // ã‚«ãƒ¼ãƒ‰ã®å†…å®¹ã‚’è¨­å®š
        card.innerHTML = `
          <div style="position: absolute; top: 20px; left: 20px; color: white; font-size: 24px; font-weight: bold; text-shadow: 0 0 5px rgba(0, 200, 255, 0.8);">${cardData[i].title}</div>
          <div style="position: absolute; top: 60px; left: 20px; color: white; font-size: 16px; width: 90%; text-shadow: 0 0 5px rgba(0, 200, 255, 0.5);">${cardData[i].content}</div>
        `;
        
        // åå°„ã‚’ä½œæˆ
        const reflection = document.createElement('div');
        reflection.className = 'card-reflection';
        
        // ã‚«ãƒ¼ãƒ‰ãƒ©ãƒƒãƒ‘ãƒ¼ã«è¿½åŠ 
        cardWrapper.appendChild(card);
        cardWrapper.appendChild(reflection);
        
        // ã‚«ãƒ«ãƒ¼ã‚»ãƒ«ã«è¿½åŠ 
        carousel.appendChild(cardWrapper);
      }
      
      // ğŸ‘‡ ã“ã“ã§æœ€åˆã‹ã‚‰ä¸¦ã¹ã¦ãŠãï¼ï¼é«˜ã•0ã ã‘ã©ä¸¦ã¹ã‚‹ï¼
      applyCardPositions(0);
    }
    
    // ã‚«ãƒ¼ãƒ‰ä½ç½®ã‚’é©ç”¨ï¼ˆactiveIndexã¨ã‚ªãƒ•ã‚»ãƒƒãƒˆã«åŸºã¥ã„ã¦ï¼‰
    function applyCardPositions(offset = 0) {
      const cardWrappers = document.querySelectorAll('.card-wrapper');
      const totalCards = cardWrappers.length;
      
      // å„ã‚«ãƒ¼ãƒ‰ã®ä½ç½®ã‚’æ›´æ–°
      cardWrappers.forEach((wrapper, i) => {
        // å®Ÿéš›ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½ç½®ã‚’è¨ˆç®—ï¼ˆã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’è€ƒæ…®ï¼‰
        // ã‚ªãƒ•ã‚»ãƒƒãƒˆã¯ -1.0 ã€œ 1.0 ã®å°æ•°å€¤
        const relativeIndex = i - activeCardIndex - offset;
        
        // ç›¸å¯¾ä½ç½®ã‚’ -2.0 ã€œ 2.0 ã®ç¯„å›²ã«æ­£è¦åŒ–ï¼ˆ5æšã‚«ãƒ¼ãƒ‰ã®å ´åˆï¼‰
        let normalizedIndex = relativeIndex;
        
        // ç„¡é™ãƒ«ãƒ¼ãƒ—ã®ãŸã‚ã€ç«¯ã‹ã‚‰ç«¯ã¸ã®ãƒ¯ãƒ¼ãƒ—ã‚’å‡¦ç†
        if (normalizedIndex < -Math.floor(totalCards / 2) - 0.5) {
          normalizedIndex += totalCards;
        } else if (normalizedIndex > Math.floor(totalCards / 2) + 0.5) {
          normalizedIndex -= totalCards;
        }
        
        // è§’åº¦ã‚’è¨ˆç®—ï¼ˆä¸­å¤®ãŒ0ã€å·¦å³ã«åºƒãŒã‚‹ï¼‰
        // æ­£è¦åŒ–ã•ã‚ŒãŸä½ç½®ã‚’ -2.0 ã€œ 2.0 ã®ç¯„å›²ã‹ã‚‰ã€è§’åº¦ç¯„å›² -theta/2 ã€œ theta/2 ã«ãƒãƒƒãƒ”ãƒ³ã‚°
        const maxPosition = Math.floor(totalCards / 2);
        const angle = (normalizedIndex / maxPosition) * (layoutConfig.theta / 2);
        
        // ä½ç½®ã‚’è¨ˆç®—ï¼ˆå††å¼§ä¸Šã®åº§æ¨™ï¼‰
        const x = Math.sin(angle) * layoutConfig.radius;
        // Zåº§æ¨™ã¯å††å¼§ã®ä¸€éƒ¨ã‚’å½¢æˆã€ä¸­å¤®ãŒæœ€ã‚‚æ‰‹å‰ã«
        const z = layoutConfig.centerZ + Math.cos(angle) * layoutConfig.radius - layoutConfig.radius;
        
        // ã‚¹ã‚±ãƒ¼ãƒ«ã¨ä¸é€æ˜åº¦ã‚’è¨ˆç®—ï¼ˆä¸­å¤®ã»ã©å¤§ããæ˜ã‚‹ãï¼‰
        const distanceRatio = Math.abs(normalizedIndex) / maxPosition;
        const scale = layoutConfig.maxScale - (layoutConfig.maxScale - layoutConfig.minScale) * distanceRatio;
        const opacity = layoutConfig.maxOpacity - (layoutConfig.maxOpacity - layoutConfig.minOpacity) * distanceRatio;
        
        // 3Dé…ç½®ã‚’è¨­å®š
        wrapper.style.transform = `translateX(${x}px) translateZ(${z}px) rotateY(${angle}rad) scale(${scale})`;
        wrapper.style.opacity = opacity;
        
        // Z-ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®èª¿æ•´ï¼ˆä¸­å¤®ãŒæœ€å‰é¢ï¼‰
        wrapper.style.zIndex = 10 - Math.abs(Math.round(normalizedIndex * 2));
      });
    }
    
    // ã‚«ãƒ¼ãƒ‰ã‚’æˆé•·ã•ã›ã‚‹
    function growCards() {
      const cards = document.querySelectorAll('.card');
      const reflections = document.querySelectorAll('.card-reflection');
      const cardWrappers = document.querySelectorAll('.card-wrapper');
      
      const growOrder = []; 
      const midIndex = Math.floor(cards.length / 2);
      for (let i = 0; i <= midIndex; i++) {
        growOrder.push(midIndex - i);
        if (midIndex + i < cards.length && midIndex + i !== midIndex) {
          growOrder.push(midIndex + i);
        }
      }
      let delay = 0;
      growOrder.forEach((index, orderIndex) => {
        setTimeout(() => {
          cards[index].style.height = '10px';
          reflections[index].style.height = '6px';
          setTimeout(() => {
            cards[index].style.height = '200px';
            cards[index].style.opacity = '1';
            reflections[index].style.height = '120px';
            setTimeout(() => {
              cards[index].style.animation = 'glowPulse 3s infinite';
              reflections[index].style.animation = 'reflectionGlow 3s infinite';
              cardWrappers[index].classList.add('floating');
              if (orderIndex === growOrder.length - 1) {
                showSwipeHint();
                isSwipeEnabled = true;
                setupSwipeEvents();
              }
            }, 2000);
          }, 500);
        }, delay);
        delay += 300;
      });
    }
    
    // ã‚¹ãƒ¯ã‚¤ãƒ—ãƒ’ãƒ³ãƒˆã‚’è¡¨ç¤º
    function showSwipeHint() {
      const swipeHint = document.querySelector('.swipe-hint');
      swipeHint.style.opacity = '1';
      
      // 10ç§’å¾Œã«éè¡¨ç¤º
      setTimeout(() => {
        swipeHint.style.opacity = '0';
      }, 10000);
    }
    
    // ã‚¹ãƒ¯ã‚¤ãƒ—ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    function setupSwipeEvents() {
      let startX = 0;
      let currentX = 0;
      let isSwiping = false;
      
      // ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆ
      document.addEventListener('touchstart', function(e) {
        if (!isSwipeEnabled) return; // å‡ºç¾ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å‰ã¯ã‚¹ãƒ¯ã‚¤ãƒ—ç„¡åŠ¹
        
        startX = e.touches[0].clientX;
        currentX = startX;
        isSwiping = true;
      });
      
      document.addEventListener('touchmove', function(e) {
        if (!isSwiping || !isSwipeEnabled) return;
        
        currentX = e.touches[0].clientX;
        
        // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãªã‚«ãƒ¼ãƒ‰ç§»å‹•
        const dragDistance = currentX - startX;
        const dragRatio = dragDistance / (layoutConfig.cardWidth * layoutConfig.cardSpacing); // ãƒ‰ãƒ©ãƒƒã‚°é‡ã‚’æ­£è¦åŒ–
        
        // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã¯ã‚ªãƒ•ã‚»ãƒƒãƒˆä»˜ãã§ä½ç½®æ›´æ–°
        applyCardPositions(dragRatio);
      });
      
      document.addEventListener('touchend', function(e) {
        if (!isSwiping || !isSwipeEnabled) return;
        
        const diffX = currentX - startX;
        handleSwipe(diffX);
        isSwiping = false;
      });
      
      // ãƒã‚¦ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆ
      document.addEventListener('mousedown', function(e) {
        if (!isSwipeEnabled) return; // å‡ºç¾ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å‰ã¯ã‚¹ãƒ¯ã‚¤ãƒ—ç„¡åŠ¹
        
        startX = e.clientX;
        currentX = startX;
        isSwiping = true;
      });
      
      document.addEventListener('mousemove', function(e) {
        if (!isSwiping || !isSwipeEnabled) return;
        
        currentX = e.clientX;
        
        // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãªã‚«ãƒ¼ãƒ‰ç§»å‹•
        const dragDistance = currentX - startX;
        const dragRatio = dragDistance / (layoutConfig.cardWidth * layoutConfig.cardSpacing); // ãƒ‰ãƒ©ãƒƒã‚°é‡ã‚’æ­£è¦åŒ–
        
        // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã¯ã‚ªãƒ•ã‚»ãƒƒãƒˆä»˜ãã§ä½ç½®æ›´æ–°
        applyCardPositions(dragRatio);
      });
      
      document.addEventListener('mouseup', function(e) {
        if (!isSwiping || !isSwipeEnabled) return;
        
        const diffX = currentX - startX;
        handleSwipe(diffX);
        isSwiping = false;
      });
      
      // ã‚¹ãƒ¯ã‚¤ãƒ—å‡¦ç†
      function handleSwipe(diffX) {
        const threshold = 50; // ã‚¹ãƒ¯ã‚¤ãƒ—ã¨åˆ¤å®šã™ã‚‹æœ€å°ã®è·é›¢
        const cardWrappers = document.querySelectorAll('.card-wrapper');
        const maxIndex = cardWrappers.length - 1;
        
        if (diffX > threshold) {
          // å³ã‚¹ãƒ¯ã‚¤ãƒ—ï¼ˆå‰ã®ã‚«ãƒ¼ãƒ‰ï¼‰- ç„¡é™ãƒ«ãƒ¼ãƒ—å¯¾å¿œ
          activeCardIndex = (activeCardIndex > 0) ? activeCardIndex - 1 : maxIndex;
          applyCardPositions(0); // ã‚ªãƒ•ã‚»ãƒƒãƒˆãªã—
        } else if (diffX < -threshold) {
          // å·¦ã‚¹ãƒ¯ã‚¤ãƒ—ï¼ˆæ¬¡ã®ã‚«ãƒ¼ãƒ‰ï¼‰- ç„¡é™ãƒ«ãƒ¼ãƒ—å¯¾å¿œ
          activeCardIndex = (activeCardIndex < maxIndex) ? activeCardIndex + 1 : 0;
          applyCardPositions(0); // ã‚ªãƒ•ã‚»ãƒƒãƒˆãªã—
        } else {
          // ã‚¹ãƒ¯ã‚¤ãƒ—ã—ãã‚Œãªã‹ã£ãŸå ´åˆã¯å…ƒã®ä½ç½®ã«æˆ»ã™
          applyCardPositions(0); // ã‚ªãƒ•ã‚»ãƒƒãƒˆãªã—
        }
      }
    }
  </script>
</body>
</html>